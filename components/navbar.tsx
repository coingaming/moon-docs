import { ModeToggle } from "@/components/theme-toggle";
import { GithubIcon } from "lucide-react";
import Link from "next/link";
import { buttonVariants } from "./ui/button";
import Anchor from "./anchor";
import { SheetLeftbar } from "./leftbar";
import { page_routes } from "@/lib/routes-config";
import { SheetClose } from "@/components/ui/sheet";
import AlgoliaSearch from "./algolia-search";

export const NAVLINKS = [
  {
    title: "Docs",
    href: `/docs${page_routes[0].href}`,
  },
  {
    title: "Knowledgebase",
    href: "/knowledgebase",
  },
];

const algolia_props = {
  appId: process.env.ALGOLIA_APP_ID!,
  indexName: process.env.ALGOLIA_INDEX!,
  apiKey: process.env.ALGOLIA_SEARCH_API_KEY!,
};

export function Navbar() {
  return (
    <nav className="w-full border-b h-16 sticky top-0 z-50 bg-background bg-blur">
      <div className="sm:container relative mx-auto w-[95vw] h-full flex items-center justify-between md:gap-2">
        <div className="flex items-center sm:gap-5 gap-2.5">
          <SheetLeftbar />
          <div className="flex items-center gap-6">
            <div className="md:flex hidden items-center gap-4 text-sm font-medium text-muted-foreground">
              <NavMenu />
            </div>
          </div>
        </div>

        <div className="lg:flex hidden absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2">
          <Logo />
        </div>

        <div className="flex items-center sm:justify-normal justify-between sm:gap-3 ml-1 sm:w-fit w-[90%]">
          <AlgoliaSearch {...algolia_props} />
          <div className="flex items-center justify-between sm:gap-2">
            <div className="flex ml-4 sm:ml-0">
              <ModeToggle />
            </div>
          </div>
        </div>
      </div>
    </nav>
  );
}

export function Logo() {
  return (
    <Link href="/" className="flex items-center gap-2.5">
      <svg
        width="101"
        height="25"
        fill="none"
        id="Layer_2"
        xmlns="http://www.w3.org/2000/svg"
        xlinkHref="http://www.w3.org/1999/xlink"
        viewBox="0 0 550 132.19422"
      >
        <defs>
          <style>
            {/* CSS content is now wrapped in a template literal */}
            {`
                        .cls-1 {
                          fill: url(#linear-gradient-3);
                        }
                        .cls-2 {
                          fill: url(#linear-gradient-2);
                        }
                        .cls-3 {
                          fill: url(#linear-gradient);
                        }
                        .cls-4 {
                          fill: var(--text-primary);
                        }
                        .cls-5 {
                          fill: #c1def4;
                        }
                      `}
          </style>
          <linearGradient
            id="linear-gradient"
            x1="55.98716"
            y1="6.75028"
            x2="119.113"
            y2="93.78943"
            gradientUnits="userSpaceOnUse"
          >
            <stop offset="0" stopColor="#8ea3b2" />
            <stop offset=".22855" stopColor="#94abba" />
            <stop offset=".60114" stopColor="#a7c0d3" />
            <stop offset=".99625" stopColor="#c1def4" />
          </linearGradient>
          <linearGradient
            id="linear-gradient-2"
            x1="91.01977"
            y1="80.27974"
            x2="124.55421"
            y2="126.51769"
            xlinkHref="#linear-gradient"
          />
          <linearGradient
            id="linear-gradient-3"
            x1=".35679"
            y1="71.53818"
            x2="173.79626"
            y2="71.53818"
            gradientUnits="userSpaceOnUse"
          >
            <stop offset="0" stopColor="#8ea3b2" />
            <stop offset=".22855" stopColor="#94abba" />
            <stop offset=".60114" stopColor="#a7c0d3" />
            <stop offset=".99625" stopColor="#c1def4" />
          </linearGradient>
        </defs>
        <g id="Layer_1-2">
          <g>
            <g>
              <path
                className="cls-4"
                d="M227.40741,109.55808h-16.64375V39.07588h16.06376v8.97282c1.93021-3.47375,4.84891-6.17261,8.7561-8.10438,3.90875-1.92865,7.93599-2.89375,12.08485-2.89375,4.72729,0,8.97282,1.06177,12.73656,3.18375,3.76219,2.12354,6.56084,5.20907,8.39438,9.26281,4.92063-8.29771,12.54167-12.44657,22.86626-12.44657,6.9475,0,12.83167,2.26698,17.65719,6.80094,4.82396,4.53708,7.23594,11.19458,7.23594,19.9725v45.73407h-16.20876v-42.98376c0-4.34219-1.13505-7.83777-3.40203-10.49297-2.26698-2.65209-5.66901-3.98047-10.20297-3.98047-4.34219,0-7.86427,1.49833-10.56469,4.48719-2.70198,2.99198-4.05219,6.70739-4.05219,11.14469v41.82532h-16.49875v-42.98376c0-4.34219-1.13505-7.83777-3.40203-10.49297-2.26698-2.65209-5.66901-3.98047-10.20297-3.98047-4.43885,0-7.98432,1.47338-10.63797,4.41547-2.65365,2.94364-3.97891,6.68089-3.97891,11.21641v41.82532Z"
              />
              <path
                className="cls-4"
                d="M362.28964,36.90556c10.61302,0,19.36912,3.52208,26.26829,10.56469,6.89761,7.04417,10.34797,15.97021,10.34797,26.77501,0,10.80636-3.45036,19.75423-10.34797,26.84673-6.89917,7.09094-15.65526,10.63641-26.26829,10.63641-10.51636,0-19.22568-3.54547-26.12173-10.63641-6.90073-7.0925-10.34797-16.04037-10.34797-26.84673,0-10.8048,3.44724-19.73084,10.34797-26.77501,6.89605-7.04261,15.60537-10.56469,26.12173-10.56469ZM348.32448,90.67074c3.81052,4.00541,8.4661,6.00734,13.96516,6.00734,5.50062,0,10.15464-1.97698,13.96672-5.93406,3.81052-3.95552,5.71734-9.45459,5.71734-16.49875,0-6.9475-1.90682-12.37485-5.71734-16.28203-3.81208-3.90719-8.4661-5.86234-13.96672-5.86234-5.49907,0-10.15464,1.95515-13.96516,5.86234-3.81364,3.90719-5.71734,9.33453-5.71734,16.28203,0,6.94594,1.9037,12.42318,5.71734,16.42548Z"
              />
              <path
                className="cls-4"
                d="M440.29622,36.90556c10.61302,0,19.36912,3.52208,26.26829,10.56469,6.89761,7.04417,10.34797,15.97021,10.34797,26.77501,0,10.80636-3.45036,19.75423-10.34797,26.84673-6.89917,7.09094-15.65526,10.63641-26.26829,10.63641-10.51636,0-19.22568-3.54547-26.12173-10.63641-6.90073-7.0925-10.34797-16.04037-10.34797-26.84673,0-10.8048,3.44724-19.73084,10.34797-26.77501,6.89605-7.04261,15.60537-10.56469,26.12173-10.56469ZM426.33106,90.67074c3.81052,4.00541,8.4661,6.00734,13.96516,6.00734,5.50062,0,10.15464-1.97698,13.96672-5.93406,3.81052-3.95552,5.71734-9.45459,5.71734-16.49875,0-6.9475-1.90682-12.37485-5.71734-16.28203-3.81208-3.90719-8.4661-5.86234-13.96672-5.86234-5.49907,0-10.15464,1.95515-13.96516,5.86234-3.81364,3.90719-5.71734,9.33453-5.71734,16.28203,0,6.94594,1.9037,12.42318,5.71734,16.42548Z"
              />
              <path
                className="cls-4"
                d="M504.12249,68.88964v40.66845h-16.78875V39.07588h16.35376v9.40781c2.21865-3.85886,5.18568-6.73078,8.9011-8.6111,3.7123-1.88187,7.69277-2.82203,11.93985-2.82203,8.29615,0,14.61688,2.60375,18.95907,7.81438s6.5125,11.91802,6.5125,20.1175v44.57564h-16.78875v-41.68188c0-4.72573-1.15688-8.51287-3.47219-11.35985-2.31687-2.84542-5.98396-4.27047-10.99969-4.27047-4.63063,0-8.22755,1.57005-10.78297,4.70391-2.55698,3.13698-3.83391,7.11589-3.83391,11.93985Z"
              />
            </g>
            <g>
              <g>
                <path
                  className="cls-3"
                  d="M32.51616,62.88766c3.09927,1.10202,6.2991,2.06234,9.557,2.92182.3702-9.36007,3.533-18.65104,9.10037-26.2677,6.33193-8.80131,15.94049-15.38212,26.52184-18.17726,10.59773-2.86851,22.28314-1.93303,32.43242,2.60599,10.15113,4.49206,18.73494,12.62518,23.81626,22.689,3.487,6.77151,5.31674,14.40532,5.38427,22.08952,1.19664-.25005,2.3921-.5037,3.57519-.78863,2.97814-.70736,5.89752-1.55387,8.7216-2.54275,1.62881-.561,3.21912-1.1865,4.7539-1.86453-.50818-8.53587-2.63347-17.0005-6.35035-24.76372-6.49789-13.83965-17.92361-25.39858-31.87698-32.06135C104.24422.02698,88.00155-1.79321,72.838,1.83012c-15.18801,3.57246-29.04023,12.44238-38.61702,24.91447-6.97547,8.98811-11.60337,19.73971-13.50288,30.98515,3.65714,1.97591,7.64161,3.69495,11.79806,5.15791Z"
                />
                <path
                  className="cls-2"
                  d="M146.42726,80.39741c-2.99217.95361-6.00257,1.7816-9.02281,2.52736-2.79231,9.87117-8.68964,18.86737-16.7868,25.34957l-3.35292,2.63883c-1.13963.83891-2.32613,1.62813-3.54888,2.3806-2.4571,1.48566-5.09018,2.76025-7.84459,3.81179-5.5093,2.10619-11.48994,3.33694-17.56657,3.66679-6.07536.32625-12.266-.23718-18.17521-1.81873-5.8908-1.5908-11.52278-4.2465-16.05031-8.17327l-.06461-.05652c-1.26738-1.10172-3.18726-1.10241-4.45747.0571-1.36775,1.24857-1.46432,3.36939-.21584,4.73704,4.94655,5.41867,11.2587,9.29809,17.90909,11.95485,6.67923,2.64468,13.76735,4.13336,20.957,4.58395,7.19092.44026,14.51398-.16566,21.68853-1.98419,3.58523-.90966,7.12982-2.13143,10.56888-3.69349,1.71524-.79146,3.40846-1.65083,5.06787-2.59654.82917-.47242,1.63495-.9919,2.45378-1.4917.80841-.51188,1.52259-1.10504,2.28705-1.65687,12.01059-9.05837,20.80645-22.47774,24.3181-37.23329.52825-2.1403.93304-4.31091,1.24166-6.49681-3.1056,1.33452-6.24414,2.49481-9.40596,3.49353Z"
                />
              </g>
              <circle
                className="cls-5"
                cx="178.46886"
                cy="56.38497"
                r="7.98277"
              />
              <path
                className="cls-1"
                d="M165.57411,71.86071c-3.09727,1.97157-6.25554,3.55346-9.45546,4.92847-3.19812,1.3867-6.43323,2.579-9.69143,3.60823-6.51591,2.07657-13.11178,3.61334-19.72899,4.81495-6.61789,1.19054-13.26306,2.09085-19.90546,2.6724-6.64722.61844-13.28689,1.00243-19.93416,1.16048-13.2902.33078-26.72087-.07684-40.27345-1.93722-6.7739-.93212-13.57879-2.24057-20.38129-4.14778-6.79982-1.89776-13.60646-4.40397-20.27766-7.97872l-.02285-.01223c-5.44394-2.91709-7.49232-9.69504-4.57521-15.13899,2.91712-5.44391,9.69506-7.49232,15.13902-4.57523.2214.11864.46189.25964.67194.39071,4.56948,2.87397,9.8204,5.28615,15.37701,7.24193,5.55256,1.97435,11.40618,3.53227,17.39438,4.7709,11.98862,2.48648,24.48771,3.7445,37.08424,4.27573,3.15028.17935,6.30041.19007,9.4561.29107,3.14263-.00663,6.30324.06719,9.43739-.03888,6.28891-.09404,12.54216-.49122,18.7385-1.14898,6.19249-.66716,12.32661-1.64411,18.27675-3.07715,2.97819-.70731,5.89752-1.55387,8.7216-2.5427,2.83027-.97475,5.56781-2.1231,8.04157-3.45597l.0763-.04112c2.80342-1.51046,6.30051-.46233,7.81097,2.34104,1.44035,2.67328.53639,5.98834-1.97981,7.59907Z"
              />
            </g>
          </g>
        </g>
      </svg>
    </Link>
  );
}

export function NavMenu({ isSheet = false }) {
  return (
    <>
      {NAVLINKS.map((item) => {
        const Comp = (
          <Anchor
            key={item.title + item.href}
            activeClassName="!text-primary dark:font-medium font-semibold"
            absolute
            className="flex items-center gap-1 sm:text-sm text-[14.5px] dark:text-stone-300/85 text-stone-800"
            href={item.href}
          >
            {item.title}
          </Anchor>
        );
        return isSheet ? (
          <SheetClose key={item.title + item.href} asChild>
            {Comp}
          </SheetClose>
        ) : (
          Comp
        );
      })}
    </>
  );
}
